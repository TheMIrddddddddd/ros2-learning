# ROS 2 è¯é¢˜çš„å‘å¸ƒä¸è®¢é˜…

---

## ç›®å½•

- [ROS 2 è¯é¢˜çš„å‘å¸ƒä¸è®¢é˜…](#ros-2-è¯é¢˜çš„å‘å¸ƒä¸è®¢é˜…)
  - [ç›®å½•](#ç›®å½•)
  - [1. è¯é¢˜ï¼ˆTopicï¼‰æ¦‚å¿µ](#1-è¯é¢˜topicæ¦‚å¿µ)
  - [2. å¸¸ç”¨å‘½ä»¤](#2-å¸¸ç”¨å‘½ä»¤)
    - [2.1 æŸ¥çœ‹è¯é¢˜åˆ—è¡¨](#21-æŸ¥çœ‹è¯é¢˜åˆ—è¡¨)
    - [2.2 æŸ¥çœ‹è¯é¢˜è¯¦æƒ…](#22-æŸ¥çœ‹è¯é¢˜è¯¦æƒ…)
    - [2.3 å®æ—¶ç›‘å¬è¯é¢˜](#23-å®æ—¶ç›‘å¬è¯é¢˜)
    - [2.4 å‘å¸ƒæ¶ˆæ¯åˆ°è¯é¢˜](#24-å‘å¸ƒæ¶ˆæ¯åˆ°è¯é¢˜)
    - [2.5 æŸ¥çœ‹å‘å¸ƒé¢‘ç‡](#25-æŸ¥çœ‹å‘å¸ƒé¢‘ç‡)
  - [3. C++ å®ç°](#3-c-å®ç°)
    - [3.1 å‘å¸ƒè€…ç¤ºä¾‹](#31-å‘å¸ƒè€…ç¤ºä¾‹)
    - [3.2 è®¢é˜…è€…ç¤ºä¾‹](#32-è®¢é˜…è€…ç¤ºä¾‹)
  - [4. Python å®ç°](#4-python-å®ç°)
    - [4.1 å‘å¸ƒè€…ç¤ºä¾‹](#41-å‘å¸ƒè€…ç¤ºä¾‹)
    - [4.2 è®¢é˜…è€…ç¤ºä¾‹](#42-è®¢é˜…è€…ç¤ºä¾‹)
  - [5. CMakeLists.txt é…ç½®](#5-cmakeliststxt-é…ç½®)
  - [6. å°ç»“](#6-å°ç»“)
  - [7. C++ è¯­æ³•çŸ¥è¯†ç‚¹](#7-c-è¯­æ³•çŸ¥è¯†ç‚¹)
    - [7.1 `const std::string&` å‚æ•°è§£æ](#71-const-stdstring-å‚æ•°è§£æ)
      - [`std::string` vs `char*`](#stdstring-vs-char)
      - [`&` å¼•ç”¨ â€”â€” é¿å…æ‹·è´](#-å¼•ç”¨--é¿å…æ‹·è´)
      - [`const` â€”â€” åªè¯»ä¿æŠ¤](#const--åªè¯»ä¿æŠ¤)
    - [7.2 `this->create_publisher<...>()` è§£æ](#72-this-create_publisher-è§£æ)
    - [7.3 èŠ‚ç‚¹ï¼ˆNodeï¼‰vs è¯é¢˜ï¼ˆTopicï¼‰](#73-èŠ‚ç‚¹nodevs-è¯é¢˜topic)
    - [7.4 `std::bind` ä¸å›è°ƒå‡½æ•°](#74-stdbind-ä¸å›è°ƒå‡½æ•°)
      - [å‡½æ•°è°ƒç”¨ vs å‡½æ•°åœ°å€](#å‡½æ•°è°ƒç”¨-vs-å‡½æ•°åœ°å€)
      - [ä¸ºä»€ä¹ˆæˆå‘˜å‡½æ•°éœ€è¦ `std::bind`ï¼Ÿ](#ä¸ºä»€ä¹ˆæˆå‘˜å‡½æ•°éœ€è¦-stdbind)
      - [`std::bind` å‚æ•°è§£é‡Š](#stdbind-å‚æ•°è§£é‡Š)
      - [Lambda æ›¿ä»£å†™æ³•ï¼ˆæ¨èï¼‰](#lambda-æ›¿ä»£å†™æ³•æ¨è)
    - [7.5 éšå¼ `this` æŒ‡é’ˆ](#75-éšå¼-this-æŒ‡é’ˆ)
      - [æˆå‘˜å‡½æ•°å†…éƒ¨ `this->` å¯çœç•¥](#æˆå‘˜å‡½æ•°å†…éƒ¨-this--å¯çœç•¥)
      - [æˆå‘˜å‡½æ•°æœ‰"éšè—å‚æ•°"](#æˆå‘˜å‡½æ•°æœ‰éšè—å‚æ•°)
      - [`std::bind` å¦‚ä½•ä¼ é€’ `this`](#stdbind-å¦‚ä½•ä¼ é€’-this)
    - [7.6 å¤æ‚ç±»å‹å®šä¹‰è§£æ](#76-å¤æ‚ç±»å‹å®šä¹‰è§£æ)
      - [æ‹†è§£](#æ‹†è§£)
      - [ä¸ºä»€ä¹ˆç”¨æŒ‡é’ˆï¼Ÿ](#ä¸ºä»€ä¹ˆç”¨æŒ‡é’ˆ)
      - [`::SharedPtr` æ˜¯ç±»å‹åˆ«å](#sharedptr-æ˜¯ç±»å‹åˆ«å)
    - [7.7 å‡½æ•°è¿”å›æŒ‡é’ˆ](#77-å‡½æ•°è¿”å›æŒ‡é’ˆ)
      - [`this` å’Œè¿”å›å€¼æ˜¯ä¸¤å›äº‹](#this-å’Œè¿”å›å€¼æ˜¯ä¸¤å›äº‹)
      - [æ‰§è¡Œè¿‡ç¨‹](#æ‰§è¡Œè¿‡ç¨‹)
      - [ç±»æ¯”](#ç±»æ¯”)
    - [7.8 ç¨‹åºæ‰§è¡Œå…¨æµç¨‹ï¼ˆDebug è§†è§’ï¼‰](#78-ç¨‹åºæ‰§è¡Œå…¨æµç¨‹debug-è§†è§’)
      - [å®Œæ•´ä»£ç ](#å®Œæ•´ä»£ç )
      - [æ‰§è¡Œæµç¨‹å›¾](#æ‰§è¡Œæµç¨‹å›¾)
      - [æ—¶é—´çº¿è§†è§’](#æ—¶é—´çº¿è§†è§’)
      - [å…³é”®ç†è§£](#å…³é”®ç†è§£)

---

## 1. è¯é¢˜ï¼ˆTopicï¼‰æ¦‚å¿µ

è¯é¢˜æ˜¯ ROS 2 ä¸­æœ€å¸¸ç”¨çš„é€šä¿¡æœºåˆ¶ä¹‹ä¸€ï¼ŒåŸºäº**å‘å¸ƒ/è®¢é˜…**æ¨¡å‹ï¼š

- **å‘å¸ƒè€…ï¼ˆPublisherï¼‰**ï¼šå‘è¯é¢˜å‘é€æ¶ˆæ¯
- **è®¢é˜…è€…ï¼ˆSubscriberï¼‰**ï¼šä»è¯é¢˜æ¥æ”¶æ¶ˆæ¯
- **å¤šå¯¹å¤šé€šä¿¡**ï¼šä¸€ä¸ªè¯é¢˜å¯ä»¥æœ‰å¤šä¸ªå‘å¸ƒè€…å’Œå¤šä¸ªè®¢é˜…è€…

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     Topic      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Publisherâ”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚Subscriberâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   /cmd_vel     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. å¸¸ç”¨å‘½ä»¤

### 2.1 æŸ¥çœ‹è¯é¢˜åˆ—è¡¨

```bash
# åˆ—å‡ºæ‰€æœ‰æ´»è·ƒçš„è¯é¢˜
ros2 topic list

# åˆ—å‡ºè¯é¢˜å¹¶æ˜¾ç¤ºæ¶ˆæ¯ç±»å‹ï¼ˆ-t / --show-typesï¼‰
ros2 topic list -t
```

**ç¤ºä¾‹è¾“å‡ºï¼š**
```
/parameter_events [rcl_interfaces/msg/ParameterEvent]
/rosout [rcl_interfaces/msg/Log]
/turtle1/cmd_vel [geometry_msgs/msg/Twist]
/turtle1/pose [turtlesim/msg/Pose]
```

### 2.2 æŸ¥çœ‹è¯é¢˜è¯¦æƒ…

```bash
# æŸ¥çœ‹è¯é¢˜ä¿¡æ¯ï¼ˆç±»å‹ã€å‘å¸ƒè€…æ•°é‡ã€è®¢é˜…è€…æ•°é‡ï¼‰
ros2 topic info /turtle1/cmd_vel

# æŸ¥çœ‹æ¶ˆæ¯ç±»å‹çš„ç»“æ„å®šä¹‰
ros2 interface show geometry_msgs/msg/Twist
```

### 2.3 å®æ—¶ç›‘å¬è¯é¢˜

```bash
# å®æ—¶æ‰“å°è¯é¢˜æ¶ˆæ¯
ros2 topic echo /turtle1/pose

# åªæ˜¾ç¤ºä¸€æ¬¡æ¶ˆæ¯
ros2 topic echo /turtle1/pose --once
```

### 2.4 å‘å¸ƒæ¶ˆæ¯åˆ°è¯é¢˜

```bash
# å‘å¸ƒä¸€æ¬¡æ¶ˆæ¯
ros2 topic pub --once /turtle1/cmd_vel geometry_msgs/msg/Twist \
  "{linear: {x: 2.0, y: 0.0, z: 0.0}, angular: {x: 0.0, y: 0.0, z: 1.8}}"

# ä»¥ 1Hz é¢‘ç‡æŒç»­å‘å¸ƒ
ros2 topic pub --rate 1 /turtle1/cmd_vel geometry_msgs/msg/Twist \
  "{linear: {x: 2.0, y: 0.0, z: 0.0}, angular: {x: 0.0, y: 0.0, z: 1.8}}"
```

### 2.5 æŸ¥çœ‹å‘å¸ƒé¢‘ç‡

```bash
ros2 topic hz /turtle1/pose
```

---

## 3. C++ å®ç°

### 3.1 å‘å¸ƒè€…ç¤ºä¾‹

```cpp
#include "rclcpp/rclcpp.hpp"
#include "std_msgs/msg/string.hpp"

class MinimalPublisher : public rclcpp::Node
{
public:
    MinimalPublisher() : Node("minimal_publisher")
    {
        // åˆ›å»ºå‘å¸ƒè€…ï¼šè¯é¢˜åã€QoS é˜Ÿåˆ—æ·±åº¦
        publisher_ = this->create_publisher<std_msgs::msg::String>("topic", 10);

        // åˆ›å»ºå®šæ—¶å™¨ï¼š500ms å‘å¸ƒä¸€æ¬¡
        timer_ = this->create_wall_timer(
            std::chrono::milliseconds(500),
            std::bind(&MinimalPublisher::timer_callback, this));
    }

private:
    void timer_callback()
    {
        auto message = std_msgs::msg::String();
        message.data = "Hello, ROS 2!";
        RCLCPP_INFO(this->get_logger(), "å‘å¸ƒ: '%s'", message.data.c_str());
        publisher_->publish(message);
    }

    rclcpp::Publisher<std_msgs::msg::String>::SharedPtr publisher_;
    rclcpp::TimerBase::SharedPtr timer_;
};

int main(int argc, char * argv[])
{
    rclcpp::init(argc, argv);
    rclcpp::spin(std::make_shared<MinimalPublisher>());
    rclcpp::shutdown();
    return 0;
}
```

### 3.2 è®¢é˜…è€…ç¤ºä¾‹

```cpp
#include "rclcpp/rclcpp.hpp"
#include "std_msgs/msg/string.hpp"

class MinimalSubscriber : public rclcpp::Node
{
public:
    MinimalSubscriber() : Node("minimal_subscriber")
    {
        // åˆ›å»ºè®¢é˜…è€…ï¼šè¯é¢˜åã€QoS é˜Ÿåˆ—æ·±åº¦ã€å›è°ƒå‡½æ•°
        subscription_ = this->create_subscription<std_msgs::msg::String>(
            "topic", 10,
            std::bind(&MinimalSubscriber::topic_callback, this, std::placeholders::_1));
    }

private:
    void topic_callback(const std_msgs::msg::String::SharedPtr msg)
    {
        RCLCPP_INFO(this->get_logger(), "æ”¶åˆ°: '%s'", msg->data.c_str());
    }

    rclcpp::Subscription<std_msgs::msg::String>::SharedPtr subscription_;
};

int main(int argc, char * argv[])
{
    rclcpp::init(argc, argv);
    rclcpp::spin(std::make_shared<MinimalSubscriber>());
    rclcpp::shutdown();
    return 0;
}
```

---

## 4. Python å®ç°

### 4.1 å‘å¸ƒè€…ç¤ºä¾‹

```python
import rclpy
from rclpy.node import Node
from std_msgs.msg import String

class MinimalPublisher(Node):
    def __init__(self):
        super().__init__('minimal_publisher')
        self.publisher_ = self.create_publisher(String, 'topic', 10)
        self.timer = self.create_timer(0.5, self.timer_callback)

    def timer_callback(self):
        msg = String()
        msg.data = 'Hello, ROS 2!'
        self.get_logger().info(f'å‘å¸ƒ: {msg.data}')
        self.publisher_.publish(msg)

def main():
    rclpy.init()
    node = MinimalPublisher()
    rclpy.spin(node)
    rclpy.shutdown()

if __name__ == '__main__':
    main()
```

### 4.2 è®¢é˜…è€…ç¤ºä¾‹

```python
import rclpy
from rclpy.node import Node
from std_msgs.msg import String

class MinimalSubscriber(Node):
    def __init__(self):
        super().__init__('minimal_subscriber')
        self.subscription = self.create_subscription(
            String, 'topic', self.listener_callback, 10)

    def listener_callback(self, msg):
        self.get_logger().info(f'æ”¶åˆ°: {msg.data}')

def main():
    rclpy.init()
    node = MinimalSubscriber()
    rclpy.spin(node)
    rclpy.shutdown()

if __name__ == '__main__':
    main()
```

---

## 5. CMakeLists.txt é…ç½®

```cmake
find_package(rclcpp REQUIRED)
find_package(std_msgs REQUIRED)

add_executable(publisher src/publisher.cpp)
ament_target_dependencies(publisher rclcpp std_msgs)

add_executable(subscriber src/subscriber.cpp)
ament_target_dependencies(subscriber rclcpp std_msgs)

install(TARGETS
    publisher
    subscriber
    DESTINATION lib/${PROJECT_NAME})
```

---

## 6. å°ç»“

| æ¦‚å¿µ | è¯´æ˜ |
|------|------|
| è¯é¢˜ | å¼‚æ­¥ã€å¤šå¯¹å¤šé€šä¿¡é€šé“ |
| å‘å¸ƒè€… | å‘è¯é¢˜å‘é€æ¶ˆæ¯ |
| è®¢é˜…è€… | ä»è¯é¢˜æ¥æ”¶æ¶ˆæ¯ |
| QoS | æœåŠ¡è´¨é‡ï¼Œæ§åˆ¶å¯é æ€§ã€å†å²è®°å½•ç­‰ |

---

## 7. C++ è¯­æ³•çŸ¥è¯†ç‚¹

### 7.1 `const std::string&` å‚æ•°è§£æ

```cpp
explicit TurtleCirclNode(const std::string& node_name) : Node(node_name)
```

**æ‹†è§£ä¸‰éƒ¨åˆ†ï¼š**

#### `std::string` vs `char*`

| ç‰¹æ€§ | `char*`ï¼ˆC é£æ ¼ï¼‰ | `std::string`ï¼ˆC++ é£æ ¼ï¼‰ |
|------|------------------|--------------------------|
| è·å–é•¿åº¦ | éœ€éå†æ‰¾ `\0` | `.length()` ç›´æ¥è·å– |
| å­—ç¬¦ä¸²æ‹¼æ¥ | å¤æ‚ï¼Œéœ€ `strcat` | `str1 + str2` ç›´æ¥æ‹¼æ¥ |
| å†…å­˜ç®¡ç† | æ‰‹åŠ¨ï¼Œæ˜“æ³„æ¼ | è‡ªåŠ¨ç®¡ç† |
| å®‰å…¨æ€§ | å®¹æ˜“è¶Šç•Œ | è¾¹ç•Œæ£€æŸ¥ |

**ç»“è®º**ï¼šC++ ä¸­ä¼˜å…ˆç”¨ `std::string`ï¼Œæ›´å®‰å…¨ã€æ›´æ–¹ä¾¿ã€‚

#### `&` å¼•ç”¨ â€”â€” é¿å…æ‹·è´

```cpp
// å€¼ä¼ é€’ï¼šå¤åˆ¶æ•´ä¸ªå­—ç¬¦ä¸²ï¼Œæµªè´¹å†…å­˜
void foo(std::string name);

// å¼•ç”¨ä¼ é€’ï¼šä¼ åœ°å€ï¼Œä¸å¤åˆ¶ï¼Œé«˜æ•ˆ
void foo(std::string& name);
```

**ç±»æ¯”**ï¼š
- å€¼ä¼ é€’ = æŠŠæ–‡ä»¶å¤å°ä¸€ä»½ç»™ä½ 
- å¼•ç”¨ä¼ é€’ = å‘Šè¯‰ä½ æ–‡ä»¶åœ¨å“ªï¼Œä½ ç›´æ¥å»çœ‹

#### `const` â€”â€” åªè¯»ä¿æŠ¤

```cpp
void foo(std::string& name) {
    name = "è¢«ä¿®æ”¹äº†";  // å¯ä»¥ä¿®æ”¹åŸæ•°æ®ï¼Œå±é™©ï¼
}

void foo(const std::string& name) {
    name = "æƒ³æ”¹";  // âŒ ç¼–è¯‘æŠ¥é”™ï¼Œä¸å…è®¸ä¿®æ”¹
}
```

**æ€»ç»“**ï¼š`const std::string&` = é«˜æ•ˆä¼ é€’ + åªè¯»ä¿æŠ¤ï¼Œæ˜¯ C++ ä¼ å­—ç¬¦ä¸²çš„æœ€ä½³å®è·µã€‚

### 7.2 `this->create_publisher<...>()` è§£æ

```cpp
this->create_publisher<geometry_msgs::msg::Twist>("/turtle1/cmd_vel", 10);
```

**é€éƒ¨åˆ†æ‹†è§£ï¼š**

| éƒ¨åˆ† | å«ä¹‰ |
|------|------|
| `this` | æŒ‡å‘å½“å‰å¯¹è±¡çš„æŒ‡é’ˆï¼ˆ"æˆ‘è‡ªå·±"ï¼‰ |
| `->` | é€šè¿‡æŒ‡é’ˆè®¿é—®æˆå‘˜ï¼ˆæŒ‡é’ˆç”¨ `->`ï¼Œå¯¹è±¡ç”¨ `.`ï¼‰ |
| `create_publisher` | ä»çˆ¶ç±» `rclcpp::Node` ç»§æ‰¿çš„æ–¹æ³• |
| `<geometry_msgs::msg::Twist>` | æ¨¡æ¿å‚æ•°ï¼ŒæŒ‡å®šæ¶ˆæ¯ç±»å‹ |
| `"/turtle1/cmd_vel"` | è¯é¢˜åç§° |
| `10` | é˜Ÿåˆ—æ·±åº¦ï¼ˆç¼“å­˜æ¶ˆæ¯æ•°é‡ï¼‰ |

**`this` å¯ä»¥çœç•¥**ï¼š
```cpp
this->create_publisher<...>(...);  // æ˜¾å¼å†™æ³•
create_publisher<...>(...);        // çœç•¥ thisï¼Œæ•ˆæœä¸€æ ·
```

### 7.3 èŠ‚ç‚¹ï¼ˆNodeï¼‰vs è¯é¢˜ï¼ˆTopicï¼‰

**å®ƒä»¬æ˜¯ä¸åŒçš„æ¦‚å¿µï¼š**

| æ¦‚å¿µ | æ˜¯ä»€ä¹ˆ | ç±»æ¯” |
|------|--------|------|
| **èŠ‚ç‚¹ï¼ˆNodeï¼‰** | ç‹¬ç«‹è¿è¡Œçš„ç¨‹åº | ç”µå°ï¼ˆå¹¿æ’­ç«™ï¼‰ |
| **è¯é¢˜ï¼ˆTopicï¼‰** | èŠ‚ç‚¹é—´é€šä¿¡çš„é€šé“ | é¢‘é“ï¼ˆFM 101.5ï¼‰ |

**é€šä¿¡æµç¨‹ï¼š**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ä½ çš„èŠ‚ç‚¹        â”‚      è¯é¢˜            â”‚  turtlesim èŠ‚ç‚¹  â”‚
â”‚  turtle_circle  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ â”‚  (å°ä¹Œé¾Ÿç¨‹åº)    â”‚
â”‚                 â”‚   /turtle1/cmd_vel   â”‚                 â”‚
â”‚  [å‘å¸ƒè€…]        â”‚                      â”‚  [è®¢é˜…è€…]        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ä¸ºä»€ä¹ˆç”¨è¯é¢˜è€Œä¸æ˜¯ç›´æ¥å‘ç»™èŠ‚ç‚¹ï¼Ÿ**
- å‘å¸ƒè€…ä¸éœ€è¦çŸ¥é“è°åœ¨è®¢é˜…ï¼ˆè§£è€¦ï¼‰
- å¯ä»¥æœ‰å¤šä¸ªèŠ‚ç‚¹è®¢é˜…åŒä¸€ä¸ªè¯é¢˜
- å¯ä»¥æœ‰å¤šä¸ªèŠ‚ç‚¹å‘å¸ƒåˆ°åŒä¸€ä¸ªè¯é¢˜
- èŠ‚ç‚¹å¯ä»¥éšæ—¶åŠ å…¥/é€€å‡ºï¼Œäº’ä¸å½±å“

**ä»£ç ä¸­çš„å¯¹åº”ï¼š**
```cpp
// èŠ‚ç‚¹åç§°
TurtleCirclNode("turtle_circle")  // â† ç¨‹åºçš„åå­—

// è¯é¢˜åç§°
create_publisher<...>("/turtle1/cmd_vel", 10);  // â† é€šä¿¡é€šé“çš„åå­—
```

### 7.4 `std::bind` ä¸å›è°ƒå‡½æ•°

```cpp
timer_ = this->create_wall_timer(1000ms, std::bind(&TurtleCirclNode::timer_callback, this));
```

#### å‡½æ•°è°ƒç”¨ vs å‡½æ•°åœ°å€

```cpp
timer_callback()   // âŒ ã€è°ƒç”¨ã€‘å‡½æ•°ï¼Œç«‹å³æ‰§è¡Œ
timer_callback     // âœ… å‡½æ•°çš„ã€åœ°å€ã€‘ï¼Œä¼ é€’"å‡½æ•°æœ¬èº«"
```

å®šæ—¶å™¨éœ€è¦"ç­‰ä¼šå„¿å†è°ƒç”¨"ï¼Œæ‰€ä»¥ä¼ åœ°å€ï¼Œä¸èƒ½åŠ æ‹¬å·ã€‚

#### ä¸ºä»€ä¹ˆæˆå‘˜å‡½æ•°éœ€è¦ `std::bind`ï¼Ÿ

**æ™®é€šå‡½æ•°**å¯ä»¥ç›´æ¥ä¼ ï¼š
```cpp
void my_function() { ... }
create_wall_timer(1000ms, my_function);  // âœ… OK
```

**æˆå‘˜å‡½æ•°**éœ€è¦å¯¹è±¡æ‰èƒ½è°ƒç”¨ï¼š
```cpp
// âŒ æˆå‘˜å‡½æ•°éœ€è¦çŸ¥é“ç”¨å“ªä¸ªå¯¹è±¡æ¥è°ƒç”¨
create_wall_timer(1000ms, timer_callback);
```

#### `std::bind` å‚æ•°è§£é‡Š

```cpp
std::bind(&TurtleCirclNode::timer_callback, this)
//        â†‘                                  â†‘
//        æˆå‘˜å‡½æ•°åœ°å€ï¼ˆè¦åŠ ç±»åå’Œ&ï¼‰           ç”¨å“ªä¸ªå¯¹è±¡è°ƒç”¨
```

**ä½œç”¨**ï¼šæŠŠæˆå‘˜å‡½æ•°å’Œå¯¹è±¡"ç»‘"åœ¨ä¸€èµ·ï¼Œç”Ÿæˆå¯ç‹¬ç«‹è°ƒç”¨çš„å›è°ƒã€‚

#### Lambda æ›¿ä»£å†™æ³•ï¼ˆæ¨èï¼‰

```cpp
// std::bind å†™æ³•
std::bind(&TurtleCirclNode::timer_callback, this)

// Lambda å†™æ³•ï¼ˆæ›´ç›´è§‚ï¼‰
[this]() { this->timer_callback(); }
```

### 7.5 éšå¼ `this` æŒ‡é’ˆ

```cpp
void timer_callback()
{
    publisher_->publish(msg);  // æ²¡å†™ thisï¼Œæ€ä¹ˆè®¿é—®æˆå‘˜å˜é‡çš„ï¼Ÿ
}
```

#### æˆå‘˜å‡½æ•°å†…éƒ¨ `this->` å¯çœç•¥

ç¼–è¯‘å™¨ä¼šè‡ªåŠ¨è¡¥ä¸Š `this->`ï¼š

```cpp
// ä½ å†™çš„
publisher_->publish(msg);

// ç¼–è¯‘å™¨ç†è§£çš„ï¼ˆç­‰ä»·ï¼‰
this->publisher_->publish(msg);
```

#### æˆå‘˜å‡½æ•°æœ‰"éšè—å‚æ•°"

æ¯ä¸ªæˆå‘˜å‡½æ•°å®é™…ä¸Šæœ‰ä¸€ä¸ªéšè—çš„ `this` å‚æ•°ï¼š

```cpp
// ä½ å®šä¹‰çš„
void timer_callback() { ... }

// ç¼–è¯‘å™¨çœ‹åˆ°çš„ï¼ˆä¼ªä»£ç ï¼‰
void timer_callback(TurtleCirclNode* this) { ... }
//                  â†‘ éšè—çš„ç¬¬ä¸€ä¸ªå‚æ•°
```

#### `std::bind` å¦‚ä½•ä¼ é€’ `this`

```
std::bind(&TurtleCirclNode::timer_callback, this)
                                            â†“
å®šæ—¶å™¨è§¦å‘æ—¶è°ƒç”¨ timer_callbackï¼Œå¹¶ä¼ å…¥ this
                                            â†“
timer_callback å†…éƒ¨é€šè¿‡ this è®¿é—®æˆå‘˜å˜é‡
```

| é—®é¢˜ | ç­”æ¡ˆ |
|------|------|
| å›è°ƒå‡½æ•°æ€ä¹ˆçŸ¥é“ç”¨å“ªä¸ªå¯¹è±¡ï¼Ÿ | `std::bind` ç»‘å®šæ—¶ä¼ å…¥äº† `this` |
| ä¸ºä»€ä¹ˆå‡½æ•°é‡Œä¸ç”¨å†™ `this`ï¼Ÿ | æˆå‘˜å‡½æ•°å†…éƒ¨ `this->` å¯çœç•¥ |
| `publisher_` å®é™…æ˜¯ä»€ä¹ˆï¼Ÿ | ç­‰äº `this->publisher_` |

### 7.6 å¤æ‚ç±»å‹å®šä¹‰è§£æ

```cpp
rclcpp::Publisher<geometry_msgs::msg::Twist>::SharedPtr publisher_;
```

#### æ‹†è§£

| éƒ¨åˆ† | å«ä¹‰ |
|------|------|
| `rclcpp::` | å‘½åç©ºé—´ï¼Œè¡¨ç¤ºæ¥è‡ª rclcpp åº“ |
| `Publisher` | å‘å¸ƒè€…ç±» |
| `<geometry_msgs::msg::Twist>` | æ¨¡æ¿å‚æ•°ï¼ŒæŒ‡å®šå‘å¸ƒä»€ä¹ˆæ¶ˆæ¯ |
| `::SharedPtr` | ç±»å‹åˆ«åï¼Œç­‰äº `std::shared_ptr<Publisher<...>>` |
| `publisher_` | å˜é‡å |

#### ä¸ºä»€ä¹ˆç”¨æŒ‡é’ˆï¼Ÿ

1. `create_publisher()` è¿”å›çš„å°±æ˜¯æ™ºèƒ½æŒ‡é’ˆ
2. Publisher å¯¹è±¡ç”± ROS2 å†…éƒ¨ç®¡ç†
3. æ™ºèƒ½æŒ‡é’ˆè‡ªåŠ¨ç®¡ç†å†…å­˜ï¼Œä¸ç”¨æ‰‹åŠ¨ delete

#### `::SharedPtr` æ˜¯ç±»å‹åˆ«å

```cpp
// ROS2 æºç é‡Œçš„å®šä¹‰ï¼ˆç®€åŒ–ï¼‰
class Publisher {
public:
    using SharedPtr = std::shared_ptr<Publisher>;  // ç±»å‹åˆ«å
};

// æ‰€ä»¥è¿™ä¸¤ä¸ªç­‰ä»·ï¼š
Publisher::SharedPtr publisher_;                        // ç®€å†™
std::shared_ptr<Publisher<Twist>> publisher_;           // å®Œæ•´å†™æ³•
```

### 7.7 å‡½æ•°è¿”å›æŒ‡é’ˆ

```cpp
publisher_ = this->create_publisher<...>(...);
```

#### `this` å’Œè¿”å›å€¼æ˜¯ä¸¤å›äº‹

```
this                          â†’  å½“å‰å¯¹è±¡çš„æŒ‡é’ˆï¼ˆç”¨æ¥è°ƒç”¨å‡½æ•°ï¼‰
create_publisher() çš„è¿”å›å€¼   â†’  æ–°åˆ›å»ºçš„ Publisher å¯¹è±¡çš„æŒ‡é’ˆ
```

#### æ‰§è¡Œè¿‡ç¨‹

```
æ­¥éª¤ 1ï¼šthis->create_publisher(...)
        ç”¨å½“å‰å¯¹è±¡è°ƒç”¨å‡½æ•°

æ­¥éª¤ 2ï¼šå‡½æ•°å†…éƒ¨ï¼ˆROS2 æºç ï¼‰
        åˆ›å»ºæ–°çš„ Publisher å¯¹è±¡
        è¿”å›æŒ‡å‘å®ƒçš„æŒ‡é’ˆ

æ­¥éª¤ 3ï¼špublisher_ = è¿”å›çš„æŒ‡é’ˆ
        ä¿å­˜åˆ°æˆå‘˜å˜é‡
```

#### ç±»æ¯”

```
ä½  (this)ï¼šå·¥å‚ï¼Œå¸®æˆ‘é€ ä¸€å°æœºå™¨
å·¥å‚ (create_publisher)ï¼šé€ å¥½äº†ï¼Œç»™ä½ åœ°å€ï¼ˆæŒ‡é’ˆï¼‰
ä½ ï¼šæŠŠåœ°å€è®°åˆ° publisher_ é‡Œï¼Œä»¥åç”¨è¿™ä¸ªåœ°å€æ“ä½œæœºå™¨
```

### 7.8 ç¨‹åºæ‰§è¡Œå…¨æµç¨‹ï¼ˆDebug è§†è§’ï¼‰

#### å®Œæ•´ä»£ç 

```cpp
int main(int argc, char const *argv[])
{
    rclcpp::init(argc, argv);
    auto node = std::make_shared<TurtleCirclNode>("turtle_circle");
    rclcpp::spin(node);
    rclcpp::shutdown();
    return 0;
}
```

#### æ‰§è¡Œæµç¨‹å›¾

```
ç¨‹åºå¯åŠ¨
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç¬¬ 33 è¡Œ: rclcpp::init(argc, argv)                              â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚ ä½œç”¨ï¼šåˆå§‹åŒ– ROS2 é€šä¿¡ç³»ç»Ÿ                                       â”‚
â”‚ å†…éƒ¨ï¼šè®¾ç½®ä¿¡å·å¤„ç†ã€åˆå§‹åŒ– DDS é€šä¿¡å±‚                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç¬¬ 35 è¡Œ: auto node = std::make_shared<TurtleCirclNode>(...)    â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚ ä½œç”¨ï¼šåˆ›å»ºèŠ‚ç‚¹å¯¹è±¡                                               â”‚
â”‚                                                                 â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚    â”‚ è¿›å…¥æ„é€ å‡½æ•° TurtleCirclNode("turtle_circle")         â”‚    â”‚
â”‚    â”‚                                                      â”‚    â”‚
â”‚    â”‚  ç¬¬ 15 è¡Œ: Node(node_name)                           â”‚    â”‚
â”‚    â”‚  â”œâ”€ è°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•°                                  â”‚    â”‚
â”‚    â”‚  â””â”€ åœ¨ ROS2 ç³»ç»Ÿä¸­æ³¨å†ŒèŠ‚ç‚¹å "turtle_circle"          â”‚    â”‚
â”‚    â”‚                                                      â”‚    â”‚
â”‚    â”‚  ç¬¬ 17 è¡Œ: publisher_ = create_publisher<Twist>(...)  â”‚    â”‚
â”‚    â”‚  â”œâ”€ åˆ›å»º Publisher å¯¹è±¡                              â”‚    â”‚
â”‚    â”‚  â”œâ”€ æ³¨å†Œè¯é¢˜ "/turtle1/cmd_vel"                      â”‚    â”‚
â”‚    â”‚  â””â”€ è¿”å›æŒ‡é’ˆï¼Œä¿å­˜åˆ° publisher_                       â”‚    â”‚
â”‚    â”‚                                                      â”‚    â”‚
â”‚    â”‚  ç¬¬ 18 è¡Œ: timer_ = create_wall_timer(1000ms, ...)    â”‚    â”‚
â”‚    â”‚  â”œâ”€ åˆ›å»ºå®šæ—¶å™¨å¯¹è±¡                                    â”‚    â”‚
â”‚    â”‚  â”œâ”€ ç»‘å®šå›è°ƒå‡½æ•° timer_callback                       â”‚    â”‚
â”‚    â”‚  â”œâ”€ è®¾ç½®é—´éš” 1000ms                                  â”‚    â”‚
â”‚    â”‚  â””â”€ è¿”å›æŒ‡é’ˆï¼Œä¿å­˜åˆ° timer_                           â”‚    â”‚
â”‚    â”‚                                                      â”‚    â”‚
â”‚    â”‚  âš ï¸ æ³¨æ„ï¼štimer_callback æ­¤æ—¶ã€ä¸æ‰§è¡Œã€‘ï¼Œåªæ˜¯ç»‘å®š      â”‚    â”‚
â”‚    â”‚                                                      â”‚    â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                 â”‚
â”‚ è¿”å›ï¼šnode æŒ‡å‘åˆ›å»ºå¥½çš„ TurtleCirclNode å¯¹è±¡                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç¬¬ 36 è¡Œ: rclcpp::spin(node)                                    â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚ ä½œç”¨ï¼šè®©èŠ‚ç‚¹ä¿æŒè¿è¡Œï¼Œå¤„ç†å›è°ƒ                                    â”‚
â”‚                                                                 â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚    â”‚                   æ— é™å¾ªç¯                            â”‚    â”‚
â”‚    â”‚                      â”‚                               â”‚    â”‚
â”‚    â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚    â”‚
â”‚    â”‚     â–¼                                 â”‚              â”‚    â”‚
â”‚    â”‚  æ£€æŸ¥å®šæ—¶å™¨æ˜¯å¦åˆ°æœŸ                     â”‚              â”‚    â”‚
â”‚    â”‚     â”‚                                 â”‚              â”‚    â”‚
â”‚    â”‚     â”œâ”€ æœªåˆ°æœŸ â†’ ç»§ç»­ç­‰å¾… â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚    â”‚
â”‚    â”‚     â”‚                                               â”‚    â”‚
â”‚    â”‚     â””â”€ åˆ°æœŸï¼ˆæ¯éš” 1000msï¼‰                           â”‚    â”‚
â”‚    â”‚           â”‚                                         â”‚    â”‚
â”‚    â”‚           â–¼                                         â”‚    â”‚
â”‚    â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚    â”‚
â”‚    â”‚    â”‚ æ‰§è¡Œ timer_callback()                   â”‚      â”‚    â”‚
â”‚    â”‚    â”‚                                         â”‚      â”‚    â”‚
â”‚    â”‚    â”‚  ç¬¬ 23 è¡Œ: auto msg = Twist()           â”‚      â”‚    â”‚
â”‚    â”‚    â”‚  â”œâ”€ åˆ›å»ºæ¶ˆæ¯å¯¹è±¡                         â”‚      â”‚    â”‚
â”‚    â”‚    â”‚                                         â”‚      â”‚    â”‚
â”‚    â”‚    â”‚  ç¬¬ 24 è¡Œ: msg.linear.x = 2             â”‚      â”‚    â”‚
â”‚    â”‚    â”‚  â”œâ”€ è®¾ç½®å‰è¿›é€Ÿåº¦                         â”‚      â”‚    â”‚
â”‚    â”‚    â”‚                                         â”‚      â”‚    â”‚
â”‚    â”‚    â”‚  ç¬¬ 25 è¡Œ: msg.angular.z = 1            â”‚      â”‚    â”‚
â”‚    â”‚    â”‚  â”œâ”€ è®¾ç½®æ—‹è½¬é€Ÿåº¦                         â”‚      â”‚    â”‚
â”‚    â”‚    â”‚                                         â”‚      â”‚    â”‚
â”‚    â”‚    â”‚  ç¬¬ 26 è¡Œ: publisher_->publish(msg)     â”‚      â”‚    â”‚
â”‚    â”‚    â”‚  â”œâ”€ å‘é€æ¶ˆæ¯åˆ°è¯é¢˜                       â”‚      â”‚    â”‚
â”‚    â”‚    â”‚  â””â”€ turtlesim æ”¶åˆ°æ¶ˆæ¯ï¼Œä¹Œé¾Ÿç§»åŠ¨         â”‚      â”‚    â”‚
â”‚    â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚    â”‚
â”‚    â”‚           â”‚                                         â”‚    â”‚
â”‚    â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚    â”‚
â”‚    â”‚                             â”‚                       â”‚    â”‚
â”‚    â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚    â”‚
â”‚    â”‚     â”‚                                               â”‚    â”‚
â”‚    â”‚     â–¼                                               â”‚    â”‚
â”‚    â”‚  ç­‰å¾…ä¸‹ä¸€æ¬¡å®šæ—¶å™¨åˆ°æœŸ...                              â”‚    â”‚
â”‚    â”‚     â”‚                                               â”‚    â”‚
â”‚    â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚    â”‚
â”‚    â”‚                                                     â”‚    â”‚
â”‚    â”‚  ğŸ’¡ spin ä¼šä¸€ç›´å¾ªç¯ï¼Œç›´åˆ°ï¼š                          â”‚    â”‚
â”‚    â”‚     - æŒ‰ä¸‹ Ctrl+C                                   â”‚    â”‚
â”‚    â”‚     - è°ƒç”¨ rclcpp::shutdown()                       â”‚    â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â”‚ ï¼ˆç”¨æˆ·æŒ‰ Ctrl+Cï¼‰
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç¬¬ 37 è¡Œ: rclcpp::shutdown()                                    â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚ ä½œç”¨ï¼šå…³é—­ ROS2 ç³»ç»Ÿ                                             â”‚
â”‚ å†…éƒ¨ï¼šé‡Šæ”¾èµ„æºã€æ–­å¼€é€šä¿¡                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç¬¬ 40 è¡Œ: return 0                                              â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚ ç¨‹åºæ­£å¸¸é€€å‡º                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### æ—¶é—´çº¿è§†è§’

```
æ—¶é—´ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶

0ms     â”‚ init() â†’ æ„é€ å‡½æ•° â†’ publisher_ åˆ›å»º â†’ timer_ åˆ›å»º â†’ spin() å¼€å§‹
        â”‚
1000ms  â”‚ timer_callback() æ‰§è¡Œ â†’ publish(msg) â†’ ä¹Œé¾ŸåŠ¨ä¸€ä¸‹
        â”‚
2000ms  â”‚ timer_callback() æ‰§è¡Œ â†’ publish(msg) â†’ ä¹Œé¾ŸåŠ¨ä¸€ä¸‹
        â”‚
3000ms  â”‚ timer_callback() æ‰§è¡Œ â†’ publish(msg) â†’ ä¹Œé¾ŸåŠ¨ä¸€ä¸‹
        â”‚
...     â”‚ ï¼ˆæ¯éš” 1 ç§’é‡å¤ï¼‰
        â”‚
ç”¨æˆ·æŒ‰   â”‚ spin() é€€å‡º â†’ shutdown() â†’ return 0
Ctrl+C  â”‚
```

#### å…³é”®ç†è§£

| é˜¶æ®µ | å‘ç”Ÿäº†ä»€ä¹ˆ |
|------|-----------|
| `init()` | å¯åŠ¨ ROS2 ç³»ç»Ÿ |
| æ„é€ å‡½æ•° | åˆ›å»ºå‘å¸ƒè€…å’Œå®šæ—¶å™¨ï¼ˆç»‘å®šå›è°ƒï¼Œä¸æ‰§è¡Œï¼‰ |
| `spin()` | è¿›å…¥å¾ªç¯ï¼Œå®šæ—¶è§¦å‘å›è°ƒ |
| `timer_callback()` | æ¯éš” 1 ç§’æ‰§è¡Œä¸€æ¬¡ï¼Œå‘å¸ƒæ¶ˆæ¯ |
| `shutdown()` | æ¸…ç†èµ„æºï¼Œé€€å‡ºç¨‹åº |
